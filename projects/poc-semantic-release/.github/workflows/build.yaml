name: Check GH CLI Version
on:
    push:
        paths-ignore:
            - 'README.md'
            - '.github/**'
            - 'docs/**'
            - '.releaserc'
    workflow_dispatch:
permissions:
    contents: write
    id-token: write

jobs:
    check-gh-cli-version:
        name: Check GH CLI Version
        runs-on: ubuntu-latest
        steps:
            - name: Checkout repository
              uses: actions/checkout@v3

            - name: Set up Node.js
              uses: actions/setup-node@v3
              with:
                  node-version: '22'
                  cache: 'npm'
            - name: Install dependencies
              run: npm install

            - name: Dry Run to get next version
              id: semver
              run: npx semantic-release --dry-run

            - name: Build
              run: |
                docker build \
                    -t poc-for-semantic-release:latest \
                    -t poc-for-semantic-release:v${{ steps.semver.outputs.version}}
